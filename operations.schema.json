{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "RemakeEngine operations schema v1",
  "description": "Schema describing operations.json files consumed by the Remake Engine.",
  "type": "object",
  "patternProperties": {
    ".*": {
      "type": "array",
      "items": { "$ref": "#/$defs/operation" }
    }
  },
  "additionalProperties": false,
  "$defs": {
    "operation": {
      "type": "object",
      "required": ["Name", "script"],
      "properties": {
        "Name": { "type": "string", "description": "Display name for the operation." },
        "Instructions": { "type": "string", "description": "Optional instructions shown to the user." },
        "script": { "type": "string", "description": "Path to the script or executable." },
        "script_type": {
          "type": "string",
          "description": "Interpreter to invoke (python, lua, js).",
          "enum": ["python", "lua", "js", "engine"],
          "default": "python"
        },
        "args": {
          "type": "array",
          "description": "Static arguments passed to the script.",
          "items": { "type": ["string", "number", "boolean"] }
        },
        "init": { "type": "boolean", "description": "Run during module initialization." },
        "run-all": { "type": "boolean", "description": "Include when performing the Run All sequence." },
        "prompts": {
          "type": "array",
          "description": "Interactive prompts displayed before execution.",
          "items": { "$ref": "#/$defs/prompt" }
        }
      },
      "additionalProperties": true
    },
    "prompt": {
      "type": "object",
      "required": ["Name", "type"],
      "properties": {
        "Name": { "type": "string" },
        "type": { "type": "string", "enum": ["confirm", "checkbox", "text"] },
        "default": {},
        "options": { "type": "array", "items": { "type": "string" } },
        "cli_arg": { "type": "string" },
        "cli_prefix": { "type": "string" },
        "cli_arg_prefix": { "type": "string" },
        "condition": { "type": "string" }
      },
      "additionalProperties": true
    }
  }
}
